---
title: "AUTOMATIZACI√ìN DE CORREOS OUTLOOK - INSTRUCCIONES"
format: html
---

## üìÅ Estructura de Archivos

```
proyecto/
‚îú‚îÄ‚îÄ automatizacion_correos.R    # Script principal
‚îú‚îÄ‚îÄ templates_correos.R         # Templates HTML (AQU√ç SE EDITAN LOS MENSAJES)
‚îî‚îÄ‚îÄ correos/
    ‚îî‚îÄ‚îÄ correos_FINAL.xlsx      # Datos de destinatarios
```

## üöÄ C√≥mo Usar

### 1. Ejecutar el Script Principal

Simplemente corre `automatizacion_correos.R`. Este script:
- Carga autom√°ticamente los templates desde `templates_correos.R`
- Lee los destinatarios del Excel
- Env√≠a los correos con formato HTML

### 2. Editar Mensajes

**IMPORTANTE**: Para cambiar el contenido o estilo de los correos, 
edita el archivo `templates_correos.R`, NO el script principal.

En `templates_correos.R` encontrar√°s:
- La funci√≥n `generar_html_reporte_semanal()` con todo el HTML
- Los estilos CSS dentro de la etiqueta `<style>`
- El contenido del mensaje

## üìù Personalizaci√≥n R√°pida

### Cambiar el texto del mensaje

Busca en `templates_correos.R` la secci√≥n que dice:

```
<p class="parrafo">
  Junto con saludar, y esperando se encuentre bien...
</p>
```
Y modifica el texto entre las etiquetas `<p>` y `</p>`.

### Cambiar colores

En la secci√≥n `<style>`, modifica:

```css
.destacado {
  text-decoration: underline;
  font-weight: bold;
  color: #0078D4;  /* ‚Üê Cambia este color */
}
```

### Cambiar fuente o tama√±o

```css
body {
  font-family: Calibri, Arial, sans-serif;  /* ‚Üê Cambia la fuente */
  font-size: 11pt;  /* ‚Üê Cambia el tama√±o */
}
```

## üé® Estilos CSS Disponibles

Las clases CSS que puedes usar en el HTML:

- `.saludo` - Para el saludo inicial
- `.parrafo` - P√°rrafos normales con justificado
- `.destacado` - Texto subrayado y en negrita
- `.negrita` - Solo negrita
- `.firma` - Bloque de firma al final
- `.nota` - Cuadro de nota con fondo gris y borde azul

### Ejemplo de uso en el HTML:

```html
<p class="parrafo">
  Este es un p√°rrafo normal con <span class="negrita">texto en negrita</span>
  y tambi√©n <span class="destacado">texto destacado</span>.
</p>
```

## ‚ûï Agregar Nuevos Templates

Si necesitas crear un nuevo tipo de correo (ej: recordatorios, notificaciones):

1. En `templates_correos.R`, agrega una nueva funci√≥n:

```r
generar_html_recordatorio <- function(saludo, nombre, fecha_limite) {
  html <- paste0('
  <html>
    <head>
      <meta charset="UTF-8">
      <style>
        /* tus estilos aqu√≠ */
      </style>
    </head>
    <body>
      <p>', saludo, ' ', nombre, ',</p>
      <p>Le recordamos que la fecha l√≠mite es: ', fecha_limite, '</p>
    </body>
  </html>
  ')
  return(html)
}
```

2. En `automatizacion_correos.R`, usa el nuevo template:

```r
cuerpo_html <- generar_html_recordatorio(
  saludo = saludo_cli,
  nombre = nombre_cli,
  fecha_limite = "23 de enero"
)
```

## ‚ö†Ô∏è Soluci√≥n de Problemas

### El correo se ve sin formato

Verifica que en `automatizacion_correos.R` est√© usando `$Mail.HTMLBody` 
y NO `$Mail.Body`.

### Caracteres especiales se ven mal

Aseg√∫rate de escapar los ap√≥strofes en el HTML:

- Incorrecto: `'An√≥tate en la lista'`

- Correcto: `\'An√≥tate en la lista\'`

### No se encuentra el archivo de templates

El archivo `templates_correos.R` debe estar en la misma carpeta 
que `automatizacion_correos.R`.

## üìã Colores √ötiles

```{r}
# Azules
#0078D4  # Azul Microsoft
#003366  # Azul oscuro
#E8F4F8  # Azul muy claro

# Grises
#333333  # Gris oscuro (texto)
#555555  # Gris medio
#F0F0F0  # Gris muy claro (fondos)

# Otros
#28A745  # Verde √©xito
#FFC107  # Amarillo advertencia
#DC3545  # Rojo error
```

## üîß Testing

Para probar sin enviar muchos correos:

```r
df <- df[1,]  # Solo primera fila
```

Para ver c√≥mo se ve el HTML antes de enviar:

```r
writeLines(cuerpo_html, "preview.html")
shell.exec("preview.html")  # Abre en navegador
```

## üìû Soporte

Para cambios en:

- **Contenido del mensaje** ‚Üí Edita `templates_correos.R`

- **Destinatarios** ‚Üí Edita el Excel

- **L√≥gica de env√≠o** ‚Üí Edita `automatizacion_correos.R`
